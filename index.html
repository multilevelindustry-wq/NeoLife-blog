<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Premium Store</title>

<style>

/* ===== SEARCH DROPDOWN ===== */
.search-container{
  position:relative;
  width:100%;
  display:flex;
  justify-content:center;
}

#searchBox{
  width:50%;
  max-width:500px;
  padding:10px;
  border-radius:6px;
  border:1px solid #ccc;
}

.search-dropdown{
  position:absolute;
  top:45px;
  width:50%;
  max-width:500px;
  background:white;
  color:#111;
  border-radius:8px;
  box-shadow:0 8px 20px rgba(0,0,0,0.3);
  max-height:300px;
  overflow-y:auto;
  display:none;
  z-index:2000;
}

.search-item{
  display:flex;
  gap:10px;
  padding:10px;
  cursor:pointer;
  border-bottom:1px solid #eee;
}

.search-item img{
  width:50px;
  height:50px;
  object-fit:cover;
  border-radius:6px;
}

.search-item:hover{
  background:#f5f5f5;
}

@media(max-width:768px){
  #searchBox, .search-dropdown{
    width:90%;
  }
}

/* ===== PRODUCTS GRID ===== */
.products{
  display:grid;
  gap:15px;
  padding:20px;
}

@media(max-width:767px){
  .products{grid-template-columns:repeat(2,1fr);}
}

@media(min-width:768px){
  .products{grid-template-columns:repeat(3,1fr);}
}

.card{
  background:white;
  color:#111;
  padding:10px;
  border-radius:8px;
  box-shadow:0 8px 20px rgba(0,0,0,0.2);
}

.card img{
  width:100%;
  height:150px;
  object-fit:cover;
  border-radius:6px;
}

button{
  padding:8px;
  border:none;
  background:#ff9800;
  color:white;
  border-radius:6px;
  cursor:pointer;
}

</style>
</head>
<body>

<header style="text-align:center; padding:20px;">
  <h2>Premium Store</h2>

  <nav>
    <a href="login.html" id="loginLink">Login</a>
    <a href="register.html" id="registerLink">Register</a>
    <a href="cart.html">Cart (<span id="cart-count">0</span>)</a>
  </nav>

  <div class="search-container">
    <input type="text" id="searchBox" placeholder="Search products...">
  </div>
</header>

<div class="products" id="homeProducts"></div>

<script src="product.js"></script>

<script>

/* ===== DISPLAY PRODUCTS ===== */
function renderHome(){
  const container = document.getElementById("homeProducts");
  container.innerHTML="";

  allProducts.forEach(p=>{
    container.innerHTML += `
      <div class="card">
        <img src="${p.image}">
        <h3>${p.title}</h3>
        <p>${p.description}</p>
        <strong>$${p.price}</strong><br>
        <button onclick="addToCart(${p.id})">Add To Cart</button>
      </div>
    `;
  });
}
renderHome();

/* ===== CART SYSTEM ===== */
function updateCartCount(){
  let cart = JSON.parse(localStorage.getItem("cart")) || [];
  document.getElementById("cart-count").innerText =
    cart.reduce((sum,i)=>sum+i.quantity,0);
}
updateCartCount();

function addToCart(id){
  let cart = JSON.parse(localStorage.getItem("cart")) || [];
  let product = allProducts.find(p=>p.id===id);

  let existing = cart.find(i=>i.id===id);
  if(existing){ existing.quantity+=1; }
  else{ cart.push({...product, quantity:1}); }

  localStorage.setItem("cart", JSON.stringify(cart));
  updateCartCount();
}

/* ===== LIVE SEARCH ===== */
const searchBox=document.getElementById("searchBox");
const dropdown=document.createElement("div");
dropdown.className="search-dropdown";
searchBox.parentElement.appendChild(dropdown);

searchBox.addEventListener("input",function(){
  let query=this.value.toLowerCase();
  dropdown.innerHTML="";
  if(query.length<1){ dropdown.style.display="none"; return; }

  let matches=allProducts.filter(p=>
    p.title.toLowerCase().includes(query) ||
    p.description.toLowerCase().includes(query)
  );

  matches.forEach(p=>{
    dropdown.innerHTML+=`
      <div class="search-item" onclick="goToProduct(${p.id})">
        <img src="${p.image}">
        <div>
          <strong>${p.title}</strong>
          <p>$${p.price}</p>
        </div>
      </div>
    `;
  });

  dropdown.style.display="block";
});

function goToProduct(id){
  window.location.href="category.html?product="+id;
}

document.addEventListener("click",function(e){
  if(!searchBox.contains(e.target)&&!dropdown.contains(e.target)){
    dropdown.style.display="none";
  }
});

</script>
</body>
</html>
